<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PC Builder Pro ‚Äî Alex</title>
  <style>
    :root{
      --bg:#0f1220; --panel:#161a2e; --muted:#2a3157; --text:#e8eaf6; --accent:#7c9cff; --good:#38d39f; --bad:#ff6b6b; --warn:#ffd166;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial}
    a{color:var(--accent)}
    .app{display:grid;grid-template-columns:320px 1fr 420px;gap:16px;padding:16px}
    header{grid-column:1/-1;background:linear-gradient(90deg, rgba(124,156,255,.15), transparent);border:1px solid var(--muted);border-radius:14px;padding:16px;display:flex;gap:12px;align-items:center}
    header h1{margin:0;font-size:20px}
    .chip{border:1px solid var(--muted);padding:6px 10px;border-radius:999px;font-size:12px;opacity:.9}
    .left,.right,.center{background:var(--panel);border:1px solid var(--muted);border-radius:14px;overflow:hidden}
    .left{height:calc(100dvh - 140px);display:flex;flex-direction:column}
    .tabs{display:flex;flex-wrap:wrap;border-bottom:1px solid var(--muted)}
    .tab{padding:10px 12px;cursor:pointer;border-right:1px solid var(--muted);font-weight:600}
    .tab.active{background:var(--bg)}
    .panel{padding:12px;overflow:auto;flex:1}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    .item{background:var(--bg);border:1px solid var(--muted);border-radius:12px;padding:10px;display:grid;grid-template-columns:64px 1fr;gap:10px;align-items:center}
    .item img{width:64px;height:64px;object-fit:contain;filter:drop-shadow(0 2px 6px rgba(0,0,0,.3))}
    .item h4{margin:0;font-size:14px}
    .meta{font-size:12px;opacity:.9}
    .btn{background:var(--accent);color:#0c1025;border:none;padding:8px 10px;border-radius:10px;font-weight:700;cursor:pointer}
    .btn.outline{background:transparent;color:var(--accent);border:1px solid var(--accent)}
    .btn.block{width:100%}
    .row{display:flex;align-items:center;justify-content:space-between;gap:8px}
    .right{padding:14px;display:flex;flex-direction:column;gap:12px;height:calc(100dvh - 140px)}
    .card{border:1px solid var(--muted);border-radius:12px;padding:12px;background:var(--bg)}
    .kpi{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .kpin{background:var(--panel);border:1px solid var(--muted);border-radius:12px;padding:12px;text-align:center}
    .kpin h2{margin:4px 0 0 0}
    .tag{padding:2px 8px;border-radius:999px;font-size:11px;border:1px solid var(--muted)}
    .good{color:var(--good);border-color:var(--good)}
    .bad{color:var(--bad);border-color:var(--bad)}
    .warn{color:var(--warn);border-color:var(--warn)}
    .compat{display:grid;gap:6px}
    .compat .row{align-items:flex-start}
    .center{padding:14px;height:calc(100dvh - 140px);overflow:auto;display:flex;flex-direction:column;gap:12px}
    .hdr{display:flex;align-items:center;justify-content:space-between}
    .list{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
    .field{display:grid;gap:6px}
    select, input[type=number], input[type=text]{background:#0b0e1d;color:var(--text);border:1px solid var(--muted);border-radius:10px;padding:10px;width:100%}
    label{font-size:12px;opacity:.85}
    canvas{width:100%;height:160px;background:#0b0e1d;border:1px solid var(--muted);border-radius:12px}
    .footer{grid-column:1/-1;padding:8px 16px;opacity:.7}
    .mini{font-size:11px;opacity:.7}
    .builds{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .savebar{display:flex;gap:8px}
    .note{font-size:12px;opacity:.85}
    .imgs{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .imgs a{display:block;background:#0b0e1d;border:1px solid var(--muted);border-radius:12px;padding:8px}
    .imgs img{width:100%;height:160px;object-fit:cover;border-radius:8px}
    .imgs figcaption{font-size:12px;opacity:.85;margin-top:6px}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>üñ•Ô∏è PC Builder Pro ‚Äî Extremo</h1>
      <span class="chip">C√°lculo de Watts</span>
      <span class="chip">Compatibilidad CPU/Placa/RAM</span>
      <span class="chip">FPS estimado</span>
      <span class="chip">Comparador de builds</span>
      <div style="margin-left:auto" class="row"><button id="darkToggle" class="btn outline">üåô Modo oscuro</button></div>
    </header>

    <!-- CATEGOR√çAS (cat√°logo) -->
    <aside class="left">
      <div class="tabs" id="tabs"></div>
      <div class="panel" id="panelItems"></div>
    </aside>

    <!-- SELECCI√ìN / CONTROLES -->
    <main class="center">
      <div class="hdr"><h2 style="margin:0">Selecciona tus componentes</h2>
        <div class="note">Precios en USD aprox. ‚Äî Datos internos (no requiere internet)</div>
      </div>
      <div class="list" id="selectors"></div>

      <div class="card">
        <div class="hdr"><h3 style="margin:0">üíæ Guardar y comparar builds</h3>
          <div class="savebar">
            <input id="buildName" type="text" placeholder="Nombre del build (ej. 1440p competitivo)" />
            <button class="btn" id="saveBuild">Guardar</button>
          </div>
        </div>
        <div class="builds">
          <div>
            <label>Comparar: Build A</label>
            <select id="compareA"></select>
            <div id="cmpAInfo" class="mini"></div>
          </div>
          <div>
            <label>Comparar: Build B</label>
            <select id="compareB"></select>
            <div id="cmpBInfo" class="mini"></div>
          </div>
        </div>
      </div>

      <div class="card">
        <h3 style="margin:0 0 8px 0">üìà Gr√°ficos</h3>
        <label>Consumo y rendimiento</label>
        <canvas id="chart"></canvas>
      </div>

      <div class="card">
        <h3 style="margin:0 0 8px 0">üéÆ Benchmarks estimados (1080p Alto)</h3>
        <div class="grid">
          <div class="kpin"><div>Fortnite</div><h2 id="fpsFortnite">‚Äî FPS</h2></div>
          <div class="kpin"><div>Cyberpunk 2077</div><h2 id="fpsCyberpunk">‚Äî FPS</h2></div>
          <div class="kpin"><div>Edici√≥n de video (export score)</div><h2 id="scoreVideo">‚Äî</h2></div>
        </div>
        <div class="mini">Estimaciones heur√≠sticas basadas en las puntuaciones de CPU/GPU y su equilibrio.</div>
      </div>

      <div class="card">
        <h3 style="margin:0 0 8px 0">üì∏ Im√°genes del trabajo</h3>
        <div class="imgs">
          <a href="/mnt/data/2caa614f-2cea-42ca-827b-aef93b93d4de.jpg" target="_blank" title="Placa base Toshiba">
            <figure>
              <img src="/mnt/data/2caa614f-2cea-42ca-827b-aef93b93d4de.jpg" alt="Placa base Toshiba A665 A660 HM65" />
              <figcaption>Placa base Toshiba A665/A660 HM65</figcaption>
            </figure>
          </a>
          <a href="/mnt/data/7bf14233-9fa7-4513-b1a5-b3ae5655013e.jpg" target="_blank" title="CPU-Z Mainboard">
            <figure>
              <img src="/mnt/data/7bf14233-9fa7-4513-b1a5-b3ae5655013e.jpg" alt="Captura CPU-Z Mainboard HM65" />
              <figcaption>CPU‚ÄëZ ‚Äî Mainboard HM65</figcaption>
            </figure>
          </a>
          <a href="/mnt/data/0a131f90-f05e-4f27-8754-6ed2658ec601.jpg" target="_blank" title="BIOS AMI 2010">
            <figure>
              <img src="/mnt/data/0a131f90-f05e-4f27-8754-6ed2658ec601.jpg" alt="BIOS AMI 2010 Toshiba i5-2410M" />
              <figcaption>BIOS AMI ‚Äî i5‚Äë2410M (2011)</figcaption>
            </figure>
          </a>
        </div>
        <div class="mini">Haz clic para ver en tama√±o completo. Si mueves el proyecto a otra carpeta, cambia las rutas en el atributo <code>src</code>.</div>
      </div>

    </main>

    <!-- PANEL DERECHA (resultados en vivo) -->
    <aside class="right">
      <div class="card kpi">
        <div class="kpin"><div>Precio Total</div><h2 id="priceTotal">$0</h2></div>
        <div class="kpin"><div>Consumo Estimado</div><h2 id="wattsTotal">0 W</h2></div>
        <div class="kpin"><div>Rendimiento</div><h2 id="perfTotal">0</h2></div>
      </div>
      <div class="card">
        <div class="row"><h3 style="margin:0">‚ö†Ô∏è Compatibilidad</h3><span id="compatBadge" class="tag warn">Por revisar</span></div>
        <div class="compat" id="compatList"></div>
      </div>
      <div class="card">
        <h3 style="margin:0 0 8px">üîß Bottleneck detector</h3>
        <div id="bottleneck" class="mini">‚Äî</div>
      </div>
      <div class="card">
        <h3 style="margin:0 0 8px">üí° Recomendaci√≥n de mejora</h3>
        <div id="upgrade" class="mini">‚Äî</div>
      </div>
      <div class="card">
        <h3 style="margin:0 0 8px">üå°Ô∏è Temperatura estimada</h3>
        <div id="temps" class="mini">‚Äî</div>
      </div>
      <div class="card">
        <h3 style="margin:0 0 8px">üì¶ Selecci√≥n actual</h3>
        <div id="summary" class="mini">‚Äî</div>
      </div>
    </aside>

    <div class="footer mini">¬© 2025 ‚Äî PC Builder Pro (Single‚ÄëFile). Hecho para Alex. üíô</div>
  </div>

  <script>
  // ==========================
  // DATASET (50+ opciones)
  // ==========================
  const DB = {
    CPU: [
      // Intel LGA1700
      {id:'i3-12100F', name:'Intel Core i3‚Äë12100F', socket:'LGA1700', ddr:'DDR4/DDR5', price:95, tdp:58, perf:80, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'},
      {id:'i5-12400F', name:'Intel Core i5‚Äë12400F', socket:'LGA1700', ddr:'DDR4/DDR5', price:140, tdp:65, perf:140, img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=200'},
      {id:'i5-13400F', name:'Intel Core i5‚Äë13400F', socket:'LGA1700', ddr:'DDR4/DDR5', price:210, tdp:65, perf:175, img:'https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=200'},
      {id:'i5-14400F', name:'Intel Core i5‚Äë14400F', socket:'LGA1700', ddr:'DDR4/DDR5', price:230, tdp:65, perf:190, img:'https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=200'},
      {id:'i7-12700F', name:'Intel Core i7‚Äë12700F', socket:'LGA1700', ddr:'DDR4/DDR5', price:280, tdp:125, perf:230, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'},
      {id:'i7-13700F', name:'Intel Core i7‚Äë13700F', socket:'LGA1700', ddr:'DDR4/DDR5', price:360, tdp:125, perf:280, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'},
      {id:'i7-14700K', name:'Intel Core i7‚Äë14700K', socket:'LGA1700', ddr:'DDR4/DDR5', price:420, tdp:125, perf:320, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'},
      {id:'i9-13900K', name:'Intel Core i9‚Äë13900K', socket:'LGA1700', ddr:'DDR4/DDR5', price:500, tdp:125, perf:360, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'},
      // AMD AM4/AM5
      {id:'r5-5600', name:'AMD Ryzen 5 5600', socket:'AM4', ddr:'DDR4', price:120, tdp:65, perf:135, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'},
      {id:'r7-5800X3D', name:'AMD Ryzen 7 5800X3D', socket:'AM4', ddr:'DDR4', price:300, tdp:105, perf:250, img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=200'},
      {id:'r5-7600', name:'AMD Ryzen 5 7600', socket:'AM5', ddr:'DDR5', price:220, tdp:65, perf:200, img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=200'},
      {id:'r7-7700', name:'AMD Ryzen 7 7700', socket:'AM5', ddr:'DDR5', price:330, tdp:65, perf:270, img:'https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=200'},
      {id:'r7-7800X3D', name:'AMD Ryzen 7 7800X3D', socket:'AM5', ddr:'DDR5', price:430, tdp:120, perf:360, img:'https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=200'},
      {id:'r9-7950X', name:'AMD Ryzen 9 7950X', socket:'AM5', ddr:'DDR5', price:540, tdp:170, perf:380, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'}
    ],
    GPU: [
      // NVIDIA
      {id:'rtx4060', name:'NVIDIA GeForce RTX 4060', price:299, tdp:115, perf:180, img:'https://images.unsplash.com/photo-1619946794135-5bc917a27793?q=80&w=200'},
      {id:'rtx4060ti', name:'NVIDIA GeForce RTX 4060 Ti', price:399, tdp:160, perf:230, img:'https://images.unsplash.com/photo-1619946794135-5bc917a27793?q=80&w=200'},
      {id:'rtx4070', name:'NVIDIA GeForce RTX 4070', price:549, tdp:200, perf:280, img:'https://images.unsplash.com/photo-1619946794135-5bc917a27793?q=80&w=200'},
      {id:'rtx4070s', name:'NVIDIA GeForce RTX 4070 SUPER', price:599, tdp:220, perf:310, img:'https://images.unsplash.com/photo-1619946794135-5bc917a27793?q=80&w=200'},
      {id:'rtx4080s', name:'NVIDIA GeForce RTX 4080 SUPER', price:999, tdp:320, perf:400, img:'https://images.unsplash.com/photo-1619946794135-5bc917a27793?q=80&w=200'},
      {id:'rtx4090', name:'NVIDIA GeForce RTX 4090', price:1699, tdp:450, perf:520, img:'https://images.unsplash.com/photo-1619946794135-5bc917a27793?q=80&w=200'},
      // AMD
      {id:'rx7600', name:'AMD Radeon RX 7600', price:259, tdp:165, perf:170, img:'https://images.unsplash.com/photo-1619946794135-5bc917a27793?q=80&w=200'},
      {id:'rx7700xt', name:'AMD Radeon RX 7700 XT', price:399, tdp:245, perf:260, img:'https://images.unsplash.com/photo-1619946794135-5bc917a27793?q=80&w=200'},
      {id:'rx7900xt', name:'AMD Radeon RX 7900 XT', price:749, tdp:315, perf:380, img:'https://images.unsplash.com/photo-1619946794135-5bc917a27793?q=80&w=200'},
      {id:'rx7900xTX', name:'AMD Radeon RX 7900 XTX', price:999, tdp:355, perf:440, img:'https://images.unsplash.com/photo-1619946794135-5bc917a27793?q=80&w=200'}
    ],
    Motherboard: [
      {id:'b660', name:'Intel B660 (LGA1700, DDR4/DDR5)', socket:'LGA1700', ddr:'DDR4/DDR5', price:120, tdp:30, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'},
      {id:'z690', name:'Intel Z690 (LGA1700, DDR5)', socket:'LGA1700', ddr:'DDR5', price:240, tdp:35, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'},
      {id:'b550', name:'AMD B550 (AM4, DDR4)', socket:'AM4', ddr:'DDR4', price:110, tdp:28, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'},
      {id:'b650', name:'AMD B650 (AM5, DDR5)', socket:'AM5', ddr:'DDR5', price:190, tdp:30, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'}
    ],
    RAM: [
      {id:'16-3200', name:'16GB (2x8) DDR4‚Äë3200', type:'DDR4', price:45, tdp:6, perf:40, img:'https://images.unsplash.com/photo-1615663245857-ac93bb7c39e7?q=80&w=200'},
      {id:'32-3600', name:'32GB (2x16) DDR4‚Äë3600', type:'DDR4', price:85, tdp:8, perf:60, img:'https://images.unsplash.com/photo-1615663245857-ac93bb7c39e7?q=80&w=200'},
      {id:'32-5600', name:'32GB (2x16) DDR5‚Äë5600', type:'DDR5', price:120, tdp:8, perf:70, img:'https://images.unsplash.com/photo-1615663245857-ac93bb7c39e7?q=80&w=200'},
      {id:'64-6000', name:'64GB (2x32) DDR5‚Äë6000', type:'DDR5', price:220, tdp:10, perf:85, img:'https://images.unsplash.com/photo-1615663245857-ac93bb7c39e7?q=80&w=200'}
    ],
    Storage: [
      {id:'ssd1', name:'1TB NVMe Gen3', type:'NVMe', price:60, tdp:4, perf:40, img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=200'},
      {id:'ssd2', name:'1TB NVMe Gen4', type:'NVMe', price:85, tdp:5, perf:55, img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=200'},
      {id:'ssd3', name:'2TB NVMe Gen4', type:'NVMe', price:150, tdp:6, perf:65, img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=200'},
      {id:'hdd2', name:'2TB HDD 7200 rpm', type:'SATA', price:50, tdp:8, perf:10, img:'https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=200'}
    ],
    PSU: [
      {id:'psu550', name:'550W 80+ Bronze', watts:550, price:55, tdp:0, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'},
      {id:'psu650', name:'650W 80+ Gold', watts:650, price:85, tdp:0, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'},
      {id:'psu750', name:'750W 80+ Gold', watts:750, price:110, tdp:0, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'},
      {id:'psu850', name:'850W 80+ Gold', watts:850, price:135, tdp:0, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'},
      {id:'psu1000', name:'1000W 80+ Platinum', watts:1000, price:199, tdp:0, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'}
    ],
    Case: [
      {id:'case1', name:'Mid Tower airflow', price:80, tdp:0, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'},
      {id:'case2', name:'ATX con vidrio templado', price:120, tdp:0, perf:0, img:'https://images.unsplash.com/photo-1587202372775-98927b415194?q=80&w=200'}
    ],
    Cooler: [
      {id:'air1', name:'Air Cooler 120mm', price:35, tdp:0, perf:0, cooling:120, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'},
      {id:'air2', name:'Air Cooler 240mm', price:60, tdp:0, perf:0, cooling:170, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'},
      {id:'aio1', name:'AIO 240mm', price:95, tdp:0, perf:0, cooling:220, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'},
      {id:'aio2', name:'AIO 360mm', price:140, tdp:0, perf:0, cooling:270, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'}
    ],
    Extras: [
      {id:'fans2', name:'Ventiladores extra (x2)', price:20, tdp:3, perf:0, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'},
      {id:'fans4', name:'Ventiladores extra (x4)', price:35, tdp:6, perf:0, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'},
      {id:'paste', name:'Pasta t√©rmica premium', price:8, tdp:0, perf:0, img:'https://images.unsplash.com/photo-1544731612-de7f96afe55f?q=80&w=200'}
    ]
  };
  const CATEGORIES = ['CPU','GPU','Motherboard','RAM','Storage','PSU','Case','Cooler','Extras'];

  // Estado
  const state = { sel: {CPU:null,GPU:null,Motherboard:null,RAM:null,Storage:null,PSU:null,Case:null,Cooler:null,Extras:null}, builds:[] };

  // UI helpers
  const $ = (q)=>document.querySelector(q);
  const $$=(q)=>Array.from(document.querySelectorAll(q));

  // Tabs + panel cat√°logo
  const tabsEl = $('#tabs');
  const panelItems = $('#panelItems');
  let activeTab = 'CPU';

  function renderTabs(){
    tabsEl.innerHTML = CATEGORIES.map(c=>`<div class="tab ${c===activeTab?'active':''}" data-tab="${c}">${c}</div>`).join('');
    $$('.tab').forEach(t=>t.onclick = ()=>{ activeTab=t.dataset.tab; renderTabs(); renderPanel(); });
  }
  function renderPanel(){
    const items = DB[activeTab];
    panelItems.innerHTML = `<div class="grid">${items.map(it=>`
      <div class="item">
        <img src="${it.img}" alt="${it.name}"/>
        <div>
          <h4>${it.name}</h4>
          <div class="meta">
            ${it.socket?`Socket: ${it.socket} ¬∑ `:''}${it.ddr?`Memoria: ${it.ddr} ¬∑ `:''}${it.type?`Tipo: ${it.type} ¬∑ `:''}
            TDP: ${it.tdp||0}W ¬∑ ${it.perf?`Perf: ${it.perf}`:''} ¬∑ Precio: $${it.price||it.price===0?it.price:0}
          </div>
          <div class="row" style="margin-top:8px">
            <button class="btn" onclick="pick('${activeTab}','${it.id}')">Seleccionar</button>
            <button class="btn outline" onclick="scrollToSelector('${activeTab}')">Ir a categor√≠a</button>
          </div>
        </div>
      </div>`).join('')}</div>`;
  }

  // Selectores principales
  const selectorsEl = $('#selectors');
  function renderSelectors(){
    selectorsEl.innerHTML = CATEGORIES.map(cat=>{
      const list = DB[cat];
      return `<div class="field">
        <label>${cat}</label>
        <select id="sel_${cat}">
          <option value="">‚Äî Elegir ${cat} ‚Äî</option>
          ${list.map(it=>`<option value="${it.id}">${it.name} ‚Äî $${it.price||0}</option>`).join('')}
        </select>
      </div>`
    }).join('');
    CATEGORIES.forEach(cat=>{
      const el = $(`#sel_${cat}`);
      el.onchange = ()=>{ state.sel[cat]= DB[cat].find(x=>x.id===el.value)||null; compute(); };
    });
  }
  function pick(cat,id){
    const el = $(`#sel_${cat}`);
    el.value = id;
    state.sel[cat]= DB[cat].find(x=>x.id===id)||null; compute();
    window.scrollTo({top:0,behavior:'smooth'});
  }
  function scrollToSelector(cat){
    document.getElementById(`sel_${cat}`).scrollIntoView({behavior:'smooth',block:'center'});
  }

  // C√°lculos
  function compute(){
    const s = state.sel;
    const price = Object.values(s).filter(Boolean).reduce((a,x)=>a+(x.price||0),0);
    const wattsBase = ['CPU','GPU','Motherboard','RAM','Storage','Extras'].reduce((a,cat)=>{
      const x=s[cat]; return a + (x? (x.tdp||0):0);
    },0);
    const headroom = Math.round(wattsBase*0.2);
    const wattsTotal = wattsBase + headroom; // margen 20%

    // Rendimiento (70% GPU, 25% CPU, 5% RAM/Storage)
    const gpuP = s.GPU?.perf||0, cpuP = s.CPU?.perf||0;
    const ramP = s.RAM?.perf||0, stoP = s.Storage?.perf||0;
    const perf = Math.round(gpuP*0.7 + cpuP*0.25 + (ramP+stoP)*0.05);

    // Compatibilidad
    const issues = [];
    if(s.CPU && s.Motherboard && s.CPU.socket!==s.Motherboard.socket) issues.push('‚ùå Socket incompatible entre CPU y Motherboard.');
    if(s.Motherboard && s.RAM){
      const ok = s.Motherboard.ddr.includes(s.RAM.type);
      if(!ok) issues.push('‚ùå Tipo de RAM no soportado por la Motherboard.');
    }
    if(s.PSU){
      const need = wattsTotal;
      if((s.PSU.watts||0) < need) issues.push(`‚ùå La fuente es insuficiente. Requerido ‚âà ${need}W, PSU: ${s.PSU.watts||0}W.`);
    }
    const compatBadge = $('#compatBadge');
    const compatList = $('#compatList');
    if(issues.length===0){ compatBadge.textContent='OK'; compatBadge.className='tag good'; compatList.innerHTML='<div class="good">‚úÖ Sin problemas detectados.</div>'; }
    else { compatBadge.textContent='Revisar'; compatBadge.className='tag warn'; compatList.innerHTML = issues.map(i=>`<div>${i}</div>`).join(''); }

    // Bottleneck detector
    let bottleneck = '‚Äî';
    if(gpuP && cpuP){
      const ratio = gpuP/cpuP; // >1: GPU m√°s fuerte
      if(ratio>1.6) bottleneck = 'üéÆ GPU muy potente para la CPU ‚Äî podr√≠as perder rendimiento en 1080p.';
      else if(ratio<0.7) bottleneck = 'üß† CPU muy potente para la GPU ‚Äî la gr√°fica limitar√° los FPS.';
      else bottleneck = '‚úÖ Balance CPU/GPU saludable.';
    }
    $('#bottleneck').textContent = bottleneck;

    // Recomendaci√≥n de mejora (mejor perf/$ marginal)
    const candidates = ['CPU','GPU','RAM','Storage'].map(cat=>{
      const cur = s[cat];
      const list = DB[cat];
      if(!cur) return null;
      // mejor opci√≥n superior
      const better = list.filter(x=>x.perf && x.perf>cur.perf).sort((a,b)=>(a.price-cur.price)/(a.perf-cur.perf) - (b.price-cur.price)/(b.perf-cur.perf))[0];
      if(!better) return null;
      const perfGain = better.perf - (cur.perf||0);
      const cost = better.price - (cur.price||0);
      return {cat, better, score: perfGain/Math.max(1,cost)};
    }).filter(Boolean).sort((a,b)=>b.score-a.score)[0];
    $('#upgrade').innerHTML = candidates? `üìå Cambia <b>${candidates.cat}</b> a <b>${candidates.better.name}</b> para la mejor ganancia perf/$.` : '‚Äî';

    // Temperatura estimada muy simplificada
    const coolingCap = s.Cooler?.cooling || 100;
    const cpuHeat = (s.CPU?.tdp||0);
    const tempCPU = Math.round(35 + (cpuHeat - (coolingCap-80))*0.25);
    $('#temps').textContent = isFinite(tempCPU)? `CPU ~ ${Math.max(35, tempCPU)}¬∞C carga (ambiente 22¬∞C, aprox.)` : '‚Äî';

    // Resumen
    $('#priceTotal').textContent = `$${price.toFixed(2)}`;
    $('#wattsTotal').textContent = `${wattsTotal} W`;
    $('#perfTotal').textContent = `${perf}`;

    $('#summary').innerHTML = Object.entries(s).map(([k,v])=>`<div><b>${k}:</b> ${v? v.name : '‚Äî'}</div>`).join('');

    // FPS/score
    const bal = Math.min(gpuP,cpuP)/Math.max(1,Math.max(gpuP,cpuP));
    const fortnite = Math.max(30, Math.round(perf*1.1*bal));
    const cyber = Math.max(25, Math.round(perf*0.6*bal));
    const video = Math.round((cpuP*0.7 + (ramP+stoP)*0.3));
    $('#fpsFortnite').textContent = `${fortnite} FPS`;
    $('#fpsCyberpunk').textContent = `${cyber} FPS`;
    $('#scoreVideo').textContent = `${video}`;

    drawChart({price, watts:wattsTotal, perf});
  }

  // Chart simple con canvas
  const ctx = document.getElementById('chart').getContext('2d');
  function drawChart({price,watts,perf}){
    const w = ctx.canvas.width, h = ctx.canvas.height; ctx.clearRect(0,0,w,h);
    const data = [
      {label:'Precio', value:price, max:3000},
      {label:'Watts', value:watts, max:1200},
      {label:'Perf', value:perf, max:600},
    ];
    const barW = (w-80)/data.length;
    data.forEach((d,i)=>{
      const x = 40 + i*barW + 10;
      const ratio = Math.min(1, d.value/d.max);
      const bh = ratio*(h-60);
      // fondo
      ctx.fillStyle = '#1a203d';
      ctx.fillRect(x, h-30-(h-60), barW-20, (h-60));
      // barra
      ctx.fillStyle = '#7c9cff';
      ctx.fillRect(x, h-30-bh, barW-20, bh);
      // texto
      ctx.fillStyle = '#e8eaf6';
      ctx.font = '12px system-ui';
      ctx.fillText(d.label, x, h-12);
      ctx.fillText((d.label==='Precio'? '$':'')+Math.round(d.value), x, h-30-bh-6);
    });
  }

  // Guardar/Comparar builds
  function saveCurrent(){
    const name = document.getElementById('buildName').value.trim(); if(!name) return alert('Pon un nombre para guardar.');
    const payload = { name, sel: JSON.parse(JSON.stringify(state.sel)) };
    const arr = JSON.parse(localStorage.getItem('pcbuilds')||'[]');
    arr.push(payload); localStorage.setItem('pcbuilds', JSON.stringify(arr));
    loadBuilds(); alert('Build guardado ‚úÖ');
  }
  function loadBuilds(){
    state.builds = JSON.parse(localStorage.getItem('pcbuilds')||'[]');
    const opts = '<option value="">‚Äî Seleccionar ‚Äî</option>' + state.builds.map((b,i)=>`<option value="${i}">${b.name}</option>`).join('');
    document.getElementById('compareA').innerHTML = opts; 
    document.getElementById('compareB').innerHTML = opts;
  }
  function renderCmpInfo(obj, el){
    if(!obj){ el.innerHTML='‚Äî'; return; }
    const s = obj.sel; 
    const price = Object.values(s).filter(Boolean).reduce((a,x)=>a+(x.price||0),0);
    const gpuP=s.GPU?.perf||0, cpuP=s.CPU?.perf||0; 
    const perf=Math.round(gpuP*0.7+cpuP*0.25+((s.RAM?.perf||0)+(s.Storage?.perf||0))*0.05);
    el.innerHTML = `üíµ $${price.toFixed(0)} ¬∑ ‚ö° ${Math.round((s.CPU?.tdp||0)+(s.GPU?.tdp||0)+30)}W base ¬∑ üß™ perf ${perf}`;
  }

  // Eventos
  document.getElementById('saveBuild').onclick = saveCurrent;
  document.getElementById('compareA').onchange = (e)=>{
    const idx = +e.target.value; const obj = state.builds[idx];
    renderCmpInfo(obj, document.getElementById('cmpAInfo'));
  };
  document.getElementById('compareB').onchange = (e)=>{
    const idx = +e.target.value; const obj = state.builds[idx];
    renderCmpInfo(obj, document.getElementById('cmpBInfo'));
  };
  document.getElementById('darkToggle').onclick = ()=>{
    const d = document.documentElement;
    if(d.dataset.theme==='light'){
      d.dataset.theme='dark';
      // back to dark
      document.body.style.background = '#0f1220';
    }else{
      d.dataset.theme='light';
      document.body.style.background = '#f6f7fb';
    }
  };

  // Inicializar
  renderTabs();
  renderPanel();
  renderSelectors();
  loadBuilds();
  compute();
  </script>
</body>
</html>
